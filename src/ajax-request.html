<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<!--my imports-->

<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<!--my imports-->

<link rel="import" href="shared-styles.html">

<dom-module id="ajax-request">
	<template>

		<style include="shared-styles">
			:host{
				display:block;
				padding:10px;
			}

			iron-icon{
				height:50px;
				width:50px;
				transition:all 0.2s;
				-webkit-transition:all 0.2s;
			}

		</style>
		<pre>User: [[gToken]]</pre>
		<pre>User: [[headers]]</pre>
		<button on-click="sendXMLHttpRequest">sendXMLHttpRequest</button>
		<iron-ajax
			auto
			method="post"
			url="[[apiEndPoint]]/rest/v1/auth-by-google"
			headers="{{headers}}"
			body="{{requestBody}}"
			handle-as="json"
			on-response="handleResponse"
			content-type="application/json"
			debounce-duration="300">
		</iron-ajax>
	</template>

	<script>
	  class AjaxRequest extends Polymer.Element {
		  static get is() {
			  return 'ajax-request';
		  }

		  static get properties() {
			  return {
				  apiEndPoint: {
					  type: String,
					  value: 'http://proveng.cloud.provectus-it.com'
				  },
				  headers: {
					  type: Object,
					  computed: '_getHeaders(customHeader)'
				  },
				  customHeader: {
					  value: 'application/json'
				  },
		      gToken: {
					  type: String,
				  },
				  requestBody: {
					  type: String,
					  computed: '_createRequestBody(gToken)',
					  notify: true
				  },
			  };
		  }

		  _getHeaders(customHeader) {
			  let header = {"content-type": customHeader}
			  return JSON.stringify(header)
		  }

		  _createRequestBody(gToken) {
			  let body = {gToken: gToken}
			  return JSON.stringify(body)
		  }

		  handleResponse(event) {
			  console.log(event);
		  }

	  }

	  window.customElements.define(AjaxRequest.is, AjaxRequest);
	</script>
</dom-module>
